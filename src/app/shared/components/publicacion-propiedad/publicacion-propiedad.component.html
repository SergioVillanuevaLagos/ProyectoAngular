<app-admin-sidebar></app-admin-sidebar>

<div class="container">
  <h1>Publicar Propiedad</h1>
  <form [formGroup]="formularioPropiedad" (ngSubmit)="alEnviar()">
    <!-- Fotos -->
    <div class="form-group">
      <label for="fotos">Fotos</label>
      <div class="fotos-container">
        <div class="foto-cuadro" (click)="inputImagenes.click()">
          <span class="plus-icon">+</span>
          <input
            #inputImagenes
            id="fotos"
            type="file"
            (change)="alCambiarArchivo($event)"
            multiple
            accept="image/*"
            style="display: none"
          />
        </div>
        <div class="miniaturas">
          <div
            class="miniatura-wrapper"
            *ngFor="let preview of imagenesPreview; let i = index"
          >
            <img [src]="preview" class="miniatura" alt="foto seleccionada" />
            <span class="eliminar-x" (click)="eliminarImagen(i)">×</span>
          </div>
        </div>
      </div>
      <div class="error" *ngIf="errorImagenes">
        Debes subir al menos una foto.
      </div>
    </div>

    <!-- Area -->
    <div class="form-group">
      <label for="area">Área (m²)</label>
      <input
        id="area"
        type="number"
        formControlName="area"
        placeholder="Área de la propiedad"
        min="1"
      />
      <div
        class="error"
        *ngIf="formularioPropiedad.get('area')?.invalid && formularioPropiedad.get('area')?.touched"
      >
        El área es obligatoria y debe ser un número positivo.
      </div>
    </div>

    <!-- Habitaciones -->
    <div class="form-group">
      <label for="habitaciones">Habitaciones</label>
      <input
        id="habitaciones"
        type="number"
        formControlName="habitaciones"
        placeholder="Número de habitaciones"
        min="0"
      />
      <div
        class="error"
        *ngIf="
          formularioPropiedad.get('habitaciones')?.invalid &&
          formularioPropiedad.get('habitaciones')?.touched
        "
      >
        El número de habitaciones es obligatorio y debe ser 0 o más.
      </div>
    </div>

    <!-- Ubicación -->
    <div class="form-group">
      <label for="ubicacion">Ubicación</label>
      <input
        id="ubicacion"
        type="text"
        formControlName="ubicacion"
        placeholder="Ubicación de la propiedad"
        maxlength="100"
      />
      <div
        class="error"
        *ngIf="
          formularioPropiedad.get('ubicacion')?.invalid &&
          formularioPropiedad.get('ubicacion')?.touched
        "
      >
        La ubicación es obligatoria y no debe superar los 100 caracteres.
      </div>
    </div>

    <!-- Descripción -->
    <div class="form-group">
      <label for="descripcion">Descripción</label>
      <textarea
        id="descripcion"
        formControlName="descripcion"
        placeholder="Describe la propiedad"
        maxlength="500"
      ></textarea>
      <div
        class="error"
        *ngIf="
          formularioPropiedad.get('descripcion')?.invalid &&
          formularioPropiedad.get('descripcion')?.touched
        "
      >
        La descripción es obligatoria y no debe superar los 500 caracteres.
      </div>
    </div>

    <!-- Precio Mensual -->
    <div class="form-group">
      <label for="precioMensual">Precio Mensual</label>
      <input
        id="precioMensual"
        type="number"
        formControlName="precioMensual"
        placeholder="Precio mensual"
        min="0"
        step="0.01"
      />
      <div
        class="error"
        *ngIf="
          formularioPropiedad.get('precioMensual')?.invalid &&
          formularioPropiedad.get('precioMensual')?.touched
        "
      >
        El precio mensual es obligatorio y debe ser mayor o igual a 0.
      </div>
    </div>

    <!-- Tipo Locacion -->
    <div class="form-group">
      <label for="tipoLocacion">Tipo de Locación</label>
      <select
        id="tipoLocacion"
        formControlName="tipoLocacion"
      >
        <option value="" disabled>Seleccione tipo</option>
        <option *ngFor="let tipo of tiposLocacion" [value]="tipo.id">
          {{ tipo.nombre }}
        </option>
      </select>
      <div
        class="error"
        *ngIf="
          formularioPropiedad.get('tipoLocacion')?.invalid &&
          formularioPropiedad.get('tipoLocacion')?.touched
        "
      >
        El tipo de locación es obligatorio.
      </div>
    </div>

    <button
      class="full-width btn-blue"
      type="submit"
      [disabled]="formularioPropiedad.invalid || errorImagenes"
    >
      Publicar
    </button>
  </form>
</div>
